syms Y R
Y=[[1279.3,496.457,0.787,0.819,6.04,3.34,0.45,51.344,179.703,0.3267,5.336,2.947,2.557,0.155,0.3977,175.04,186.849,199.9,3.34,8.23,24.3,20.519,275.06,225.5,4.14,72.7,0.241,36.42,-2.11,11.18];[1870.93,538.451,0.057,0.404,5.42,3,1.37,10.278,79.239,0.3061,5.09,2.239,1.334,3.038,1.6627,207.778,222.278,210.3,3.72,4.67,45.03,21.85,95.94,172.5,3.96,69.4,0.192,37.1,2,14.31];[5022.14,467.239,0.171,2.79,11.79,9.63,0,12.571,43.218,0.2837,6.972,2.99,3.809,1.357,1.6333,180.595,232.429,214.9,3.82,3.82,56.2,24.144,213.22,164.2,3.74,74.4,0.253,37.02,-0.83,13.11];[2085.76,496.201,0.576,2.032,6.92,4.04,0.86,32.551,25.34,0.3685,5.248,3.148,1.548,0.53,1.3188,206.885,212.442,209.1,3.67,6,34.87,24.465,110.99,116,3.64,72.4,0.124,43.9,-4.32,18.41];[2658.04,467.203,0.11,0.388,9.2,6.54,5.4,14.298,137.636,0.2462,6.323,2.626,2.379,1.162,3.1705,202.917,256.02,219.6,3.67,7.2,30.47,25.097,112.78,143.5,4.15,69.2,0.264,40.29,-3.69,19.47];[1847.12,499.08,0.255,0.834,8.32,5.68,0.33,14.828,143.493,0.3369,10.541,4.502,6.36,1.727,8.0864,186.448,220.124,196.4,3.64,7.81,25.15,23.572,296.71,171.9,4.99,78.5,0.203,39.31,-5.44,13.07];[1721.58,560.343,0.214,2.477,4.24,7.11,1.36,17.31,75.887,0.3709,10.267,4.729,6.824,1.235,4.7952,161.746,242.2,174.4,3.19,7.42,23.5,23.907,234.9,178.3,2.86,68.4,0.17,42.01,-4.6,14.23];[1273.22,493.739,0.031,2.864,7.59,2.11,2.71,58.731,189.667,0.1045,5.134,1.672,2.838,0.137,5.608,157.778,196.156,174.8,3.8,4.25,41.17,21.36,285.06,235.5,3.75,78.8,0.2,35.53,-0.37,8.91];[1927.42,482.855,0.05,3.685,10.29,3.77,3.97,32.31,44.976,0.3787,5.814,4.434,2.785,0.087,0.7518,209.464,220.415,228.9,3.7,4.07,56.22,25.231,138.23,127.5,3.85,64.6,0.163,38.25,-1.79,13.58];[2095.61,515.756,0.088,0.844,7.34,3.35,0.22,31.876,192.731,0.3421,7.728,6.781,3.487,0.246,1.1776,217.996,243.081,219.4,3.59,6.68,32.88,22.84,125.62,285.4,3.66,70.8,0.256,38.96,-3.19,12.72];[1566.97,557.441,0.032,0.407,7.2,2.07,1.9,38.583,218.452,0.232,7.854,3.312,4.404,0.822,1.8589,167.202,174.03,188.8,3.93,3.31,56.98,21.558,316.51,184.5,3.26,71.8,0.173,41.14,-1.07,14.58];[1724.16,457.649,0.125,0.409,4.64,0,2.17,18.473,148.364,0.449,8.483,3.212,4.314,0.752,8.4308,209.365,250.51,211.4,3.83,4.46,47.39,23.329,285.82,202.5,2.41,71.7,0.229,37.6,-4.11,10.23];[664.96,459.397,0.55,2.509,4.9,3.53,1.19,26.517,118.628,0.4094,11.774,2.129,7.044,0.095,0.2103,153.909,177.755,187.1,3.58,6.31,29.67,18.295,286.1,271,3.4,77.1,0.373,36.76,-3.91,9.71];[1542.17,524.857,0.165,0.404,3.31,3.74,0.49,31.823,530.556,0.4177,5.324,2.388,2.393,0.095,1.3006,177.222,253.4,201.1,3.39,5.91,34,24.617,145.27,134.7,3.5,77.3,0.157,40.61,-3.32,17.11];[2669.22,546.446,0.042,1.629,5.55,3.78,0.83,8.381,91.796,0.354,8.871,2.751,5.19,4.023,11.8734,169.98,212.712,172.7,3.67,7.84,22.03,22.403,498.78,340.8,3.59,71,0.272,36.03,2.07,9.71];[991.92,464.819,0.265,4.103,5.75,2.18,1.63,52.684,144.825,0.0976,5.007,2.228,3.135,1.572,5.314,170.675,216.733,192,3.23,3.74,51.39,21.536,259.11,198.2,5.15,71.5,0.245,30.82,6.43,1.82];[1167.29,416.876,0.904,2.089,10.21,1.75,0.09,20.576,134.629,0.2599,6.575,2.247,2.323,1.026,6.0135,192.401,182.553,194.2,3.67,4.97,39.1,21.506,111.53,114,6.27,75.2,0.12,43.34,-0.75,14.9];[1289.93,581.913,0.185,0.812,3.98,7.49,0.59,25.726,133.056,0.2113,11.957,5.783,6.261,1.82,2.7771,183.968,198.668,186.3,3.5,8.17,22.8,22.021,286.24,149,3.35,82.8,0.148,39.97,-1.69,13.29];[817.81,455.675,0.034,2.072,9.38,3.71,2.45,30.299,27.517,0.2004,4.725,2.217,2.152,1.782,0.8535,199.147,210.105,202.2,3.88,3.41,59.32,23.078,165.06,137.4,3.06,69.2,0.213,29.77,8.43,5.36];[2045.24,479.934,0.085,0.829,10.65,5.49,4.82,29.427,150.273,0.335,5.251,3.141,2.341,0.157,6.1633,219.782,235.097,220.7,3.48,8.48,26.03,23.772,205.54,146.2,5.19,75.8,0.225,39.51,-1.44,15.91];[1554.02,585.359,0.684,0.819,8.5,2.24,0.65,24.02,1167.648,0.2526,4.367,1.952,0.744,0.845,0.7158,209.266,228.364,211.4,3.6,6.88,30.73,22.218,92.88,145.5,3.66,69.6,0.163,40.55,-6.07,19.54];[1457.67,402.156,0.552,1.651,8.97,1.06,1.77,36.455,63.447,0.366,6.409,6.463,2.71,0.969,8.9296,167.202,225.523,209.1,3.99,5.42,38.55,23.707,73.36,88.2,4.74,68.6,0.121,34.35,6.81,10.2];[1522.52,505.339,0.066,1.244,8.28,2.23,0.29,20.153,839.45,0.36,5.127,3.389,2.508,1.65,12.4106,199.345,253.514,221.8,3.71,4.86,45.71,25.204,186.74,143.4,5.39,68.5,0.142,42.21,-1.7,17.96];[3068.34,629.801,0.152,0.372,6.96,2.63,0.48,14.116,90.611,0.4066,10.755,8.506,7.923,0.483,3.2138,229.306,227.25,231.1,3.72,6.6,35,24.536,200.52,226.2,2.64,66.6,0.298,39.6,-2.36,11.9];[2350.79,516.862,0.11,0.67,6.95,4.95,1.11,34.458,205.61,0.2125,7.666,2.757,2.625,0.85,8.6195,222.956,255.29,224.1,3.8,4.98,45,26.534,141.94,148.7,2.92,74.7,0.219,34.1,5.87,10.04];[2073.33,496.835,0.191,1.657,6.81,0,0.09,18.291,14.674,0.2998,5.816,5.517,2.816,1.426,4.3089,224.841,259.877,226.4,3.83,5.29,42.83,26.487,104.91,127.9,3.85,56,0.155,40.79,-1.85,15.18];[2475.21,642.373,0.22,0.42,8.3,6.2,4.91,19.817,870.194,0.385,16.965,6.251,9.526,1.155,50.4966,190.615,224.944,212.6,3.66,4.05,52.59,24.477,166.08,177.3,2.66,64.1,0.229,40.6,0.98,12.91];[3785.57,450.458,0.117,2.057,8.89,5.05,3.13,46.158,74.477,0.3654,6.567,4.583,3.885,2.921,5.7323,220.079,239.325,226.6,3.59,6,37.76,25.301,108.76,114.4,3.57,65.5,0.146,42.13,-5.31,20.26]];

R=corr(Y);
[V,D]=eig(R);%第i个特征值为D(i,i)，对应V(:,i)列向量

%disp(V);

syms k yita p;
p=0;
%sumK=0;
k=0;
for j=1:1:30
    p=p+D(j,j);
end
%第i个主成分贡献率为yita(i)
for i=1:1:30
    yita(i)=D(i,i)/p;
    yita(i)=vpa(yita(i),7);
end
syms accuyita
accuyita(1)=yita(1);
for i=2:1:30
    accuyita(i)=yita(i)+accuyita(i-1);
end
disp(accuyita);
syms f m
m=7;%由上个得到m=5
for i=1:1:28
    for j=1:1:7
        f(i,j)=V(i,j)*Y(i,j);
        f(i,j)=vpa(f(i,j),4);
    end
end
disp(f)

syms W
W=zeros(1,28);
for i=1:1:28
    for J=1:1:7
        W(i)=W(i)+f(i,j)*yita(j);
    end
end
disp(W);